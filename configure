set -x
# check that files are compilable
ocamlbuild -use-ocamlfind src/Controller.cmx src/DataItem.cmx src/AbstractModel.cmx src/HistoryModel.cmx


RCC=rcc
which rcc-qt5
if [ $? != 0 ]; then
    RCC=rcc
fi

find .

cd src 
$RCC -name resources resources.qrc -o qrc_resources.c
cd ..

# generate required .cpp and .h files
cd _build # we are donig this in the _build dir to prevent sanitize errors
ocamlfind opt -thread -package lablqml -ppx "ppx_qt --as-ppx -destdir ../src/ -ext c" -c \
    src/Controller.ml src/DataItem.ml src/AbstractModel.ml src/HistoryModel.ml

